<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.java501.S20230401.ArticleMapper">

	<select id="ArticleTotalCnt" resultType="int">
		select Count(*) FROM article where substr(brd_id, 0,2)=10
	</select>

	<select id="ArticleBoardCnt" parameterType="Article"  resultType="int">
		select Count(*) FROM article where brd_id=#{brd_id}
	</select>


	<select id="tkArticleListAll" parameterType="Article" resultType="Article">
        SELECT   A.ART_TAG1, A.ART_TAG2, A.ART_TAG3, A.ART_TAG4, A.ART_ID, A.BRD_ID
				,A.ART_TAG5, A.ART_TITLE, trunc(sysdate-A.ART_REGDATE) as REST_REGDATE, A.ART_READ
				,M.MEM_ID, M.MEM_NICKNAME
				,T.TRD_ID, T.TRD_LOC, T.TRD_MAX, T.TRD_STATUS
				,C.COMM_ID, C.COMM_VALUE
				,T.TRD_MINAGE, T.TRD_MAXAGE
                ,reply_count(A.ART_ID, A.BRD_ID)  repCount
		FROM     ARTICLE A, TRADE T, COMM C, MEMBER M
		WHERE    A.TRD_ID = T.TRD_ID
		AND      T.TRD_STATUS =	C.COMM_ID
		AND      M.MEM_ID = A.MEM_ID
		AND      substr(a.brd_id, 0,2)=10
		ORDER BY A.BRD_ID

	</select>
	
		<select id="tkArticleListBoard" parameterType="Article"	resultType="Article">
        SELECT   A.ART_TAG1, A.ART_TAG2, A.ART_TAG3, A.ART_TAG4, A.ART_ID, A.BRD_ID
				,A.ART_TAG5, A.ART_TITLE, trunc(sysdate-A.ART_REGDATE) as REST_REGDATE, A.ART_READ
				,M.MEM_ID, M.MEM_NICKNAME
				,T.TRD_ID, T.TRD_LOC, T.TRD_MAX, T.TRD_STATUS
				,C.COMM_ID, C.COMM_VALUE
				,T.TRD_MINAGE, T.TRD_MAXAGE
                ,reply_count(A.ART_ID, A.BRD_ID)  repCount
		FROM     ARTICLE A ,TRADE T, COMM C, MEMBER M
		WHERE    A.TRD_ID = T.TRD_ID
		AND      T.TRD_STATUS =	C.COMM_ID
		AND      M.MEM_ID = A.MEM_ID
		AND      a.brd_id = #{brd_id}
		ORDER BY A.BRD_ID

	</select>
	

	<select id="tkArticleDetail" parameterType="Article" resultType="Article">
		SELECT *
		FROM   ARTICLE A
             , TRADE   T
             , COMM    C
             , MEMBER  M
 		WHERE A.TRD_ID   = T.TRD_ID
		AND   T.TRD_STATUS = C.COMM_ID
		AND   M.MEM_ID     = A.MEM_ID
		AND   a.brd_id = #{brd_id}
		AND   a.art_id = #{art_id}
		ORDER BY		A.BRD_ID
	</select>
</mapper>