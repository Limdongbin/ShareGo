<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.java501.S20230401.ArticleMapper"> 

	<!-- 리스트 조회-->
	<select id="ArticleTotal" resultType="int">
		select Count(*) FROM article
	</select>
	
	<!-- 페이지 불러오기 -->
	<select id="cyArticleListAll" parameterType="Article" resultType="Article">
		<![CDATA[
		
		SELECT *
		FROM
		(
		    SELECT rownum rn, a.*
		    FROM
		        (SELECT * FROM article WHERE brd_id >= 1400 AND brd_id < 1500 ORDER BY art_id) a
		)
			WHERE rn >= #{start}
			and   rn <= #{end}
		]]>
	</select>

	
	<!-- 게시판 보기 -->
	<select id="cyArticlereadDetail" parameterType="Article" resultType="Article">
			select *
			from article a
			left join member m 
			on a.mem_id = m.mem_id
			where a.art_id=#{art_id} and a.brd_id = #{brd_id}
	</select>

	<!-- 게시판 보기(수정페이지) -->
	<select id="cyArticlereadupdate" parameterType="Article" resultType="Article">
			select *
			from article 
			where art_id=#{art_id} and brd_id = #{brd_id}
	</select>
	<select id="count" resultType="int">
	 select count(brd_id) from article
	</select>

	<!-- 게시글 작성 -->
 	<insert id="insert" parameterType="Article">
		insert into 
			article(art_id, brd_id, art_title, art_tag1, art_content)
			values((Select max(art_id) + 1 from article where brd_id = #{brd_id}), #{brd_id}, #{art_title}, #{art_content}, #{art_content})
	</insert> 
	
		<!-- 게시글 작성 -->
   	<insert id="write" parameterType="Article">
		insert into 
			article(brd_id, art_title, art_tag1, art_content)
			values(#{brd_id}, #{art_title}, #{art_content}, #{art_content})
	</insert>  
 	
 	
		<!-- 게시글 수정 -->
   	<select id="update" parameterType="Article">
		insert into 
			article(brd_id, art_title, art_tag1, art_content)
			values(#{brd_id}, #{art_title}, #{art_content}, #{art_content})
	</select>  
 
    	<!-- 글 수정하기 -->
	 <update id = "modify" parameterType="Article">
			update article 
		set 
			art_title = #{art_title, jdbcType=VARCHAR},
			art_tag1 = #{art_tag1, jdbcType=VARCHAR},
			art_tag2 = #{art_tag2, jdbcType=VARCHAR},
			art_tag3 = #{art_tag3, jdbcType=VARCHAR},
			art_tag4 = #{art_tag4, jdbcType=VARCHAR},
			art_tag5 = #{art_tag5, jdbcType=VARCHAR},
			art_content = #{art_content, jdbcType=CLOB} 
		where art_id = #{art_id, jdbcType=NUMERIC} and brd_id = #{brd_id, jdbcType=NUMERIC}
	</update>
			
	<insert id="hgInsertArticle" parameterType="Article">
		<!-- INSERT INTO ARTICLE (ART_ID, BRD_ID, ART_TITLE, MEM_ID, ART_REGDATE, ART_CONTENT,
							 ART_TAG1, ART_TAG2, ART_TAG3, ART_TAG4, ART_TAG5, TRD_ID, ART_GOOD,
							 ART_BAD, ART_READ, ART_ISNOTICE, ISDELETE, REPORT_ID)
		VALUES ((SELECT MAX(ART_ID) + 1 FROM ARTICLE WHERE BRD_ID = #{brd_id}), #{brd_id},
				#{art_title, jdbcType=VARCHAR}, #{mem_id}, SYSDATE, #{art_content, jdbcType=VARCHAR},
				#{art_tag1, jdbcType=VARCHAR}, #{art_tag2, jdbcType=VARCHAR}, #{art_tag3, jdbcType=VARCHAR},
				#{art_tag4, jdbcType=VARCHAR}, #{art_tag5, jdbcType=VARCHAR}, #{trd_id, jdbcType=NUMERIC},
				0, 0, 0, 0, 0, NULL) -->
		INSERT INTO ARTICLE (ART_ID, BRD_ID, ART_TITLE, MEM_ID, ART_REGDATE, ART_CONTENT,
							 ART_TAG1, ART_TAG2, ART_TAG3, ART_TAG4, ART_TAG5, TRD_ID, ART_GOOD,
							 ART_BAD, ART_READ, ART_ISNOTICE, ISDELETE, REPORT_ID)
		VALUES ((SELECT MAX(ART_ID) + 1 FROM ARTICLE WHERE BRD_ID = #{brd_id}), #{brd_id},
				#{art_title, jdbcType=VARCHAR}, #{mem_id}, SYSDATE, #{art_content, jdbcType=VARCHAR},
				#{art_tag1, jdbcType=VARCHAR}, #{art_tag2, jdbcType=VARCHAR}, #{art_tag3, jdbcType=VARCHAR},
				#{art_tag4, jdbcType=VARCHAR}, #{art_tag5, jdbcType=VARCHAR}, NULL,
				0, 0, 0, 0, 0, NULL)
	</insert>
	<select id="hgGetArticleById" parameterType="Article" resultType="Article">
		SELECT * FROM ARTICLE
		WHERE ART_ID = #{art_id} AND BRD_ID = #{brd_id}
	</select>
</mapper>