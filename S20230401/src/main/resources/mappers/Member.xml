<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.java501.S20230401.model.MemberMapper">

	<!-- 유현규 -->
	<select id="hgGetMemberByUsername" parameterType="java.lang.String" resultType="Member">
		SELECT * FROM MEMBER WHERE MEM_USERNAME = #{username}
	</select>
	<select id="hgGetMemberByEmail" parameterType="java.lang.String" resultType="Member">
		SELECT * FROM MEMBER WHERE MEM_EMAIL = #{email}
	</select>
	<select id="hgGetMemberByNickname" parameterType="java.lang.String" resultType="Member">
		SELECT * FROM MEMBER WHERE MEM_NICKNAME = #{nickname}
	</select>
	<insert id="hgRegistMember" parameterType="Member">
		INSERT INTO MEMBER(MEM_ID, MEM_USERNAME, MEM_PASSWORD, MEM_NICKNAME,
						   MEM_EMAIL, MEM_TEL, MEM_REGION1, MEM_REGION2,
						   MEM_AUTHORITY, MEM_REGDATE, MEM_IMAGE, MEM_GENDER,
						   MEM_NAME, MEM_BIRTHDAY, MEM_LATEST, ISDELETE)
					VALUES ((SELECT MAX(MEM_ID) + 1 FROM MEMBER), #{mem_username, jdbcType=VARCHAR}, #{mem_password, jdbcType=VARCHAR}, #{mem_nickname, jdbcType=VARCHAR},
							#{mem_email, jdbcType=VARCHAR}, #{mem_tel, jdbcType=VARCHAR}, #{mem_region1, jdbcType=NUMERIC}, #{mem_region2, jdbcType=NUMERIC},
							101, SYSDATE, #{mem_image, jdbcType=VARCHAR}, #{mem_gender, jdbcType=NUMERIC}, #{mem_name, jdbcType=VARCHAR},
							#{mem_birthday, jdbcType=TIMESTAMP}, SYSDATE, 0)
	</insert>
	<select id="hgGetMemberById" parameterType="int" resultType="Member">
		SELECT * FROM MEMBER WHERE MEM_ID = #{mem_id}
	</select>
	<update id="hgSetAuthority" parameterType="Member">
		UPDATE MEMBER SET MEM_AUTHORITY = #{mem_authority, jdbcType=NUMERIC} WHERE MEM_ID = #{mem_id, jdbcType=NUMERIC}
	</update>






	<!-- 양동균 -->
	<resultMap type="Member" id="dgMemberMap">
		<id 	column="mem_id" 		property="mem_id"/>	<!-- PK -->
		<result column="mem_username"	property="mem_username"/>
		<result column="mem_password"	property="mem_password"/>
		<result column="mem_nickname"	property="mem_nickname"/>
		<result column="mem_email"		property="mem_email"/>
		<result column="mem_tel"		property="mem_tel"/>
		<result column="mem_region1"	property="mem_region1"/>
		<result column="mem_region2"	property="mem_region2"/>
		<result column="mem_authority"	property="mem_authority"/>
		<result column="mem_regdate"	property="mem_regdate"/>
		<result column="mem_image"		property="mem_image"/>
		<result column="mem_gender"		property="mem_gender"/>
		<result column="mem_name"		property="mem_name"/>
		<result column="mem_birthday"	property="mem_birthday"/>
		<result column="mem_latest"		property="mem_latest"/>
		<result column="isdelete"		property="isdelete"/>
		<result column="report_id"		property="report_id"/>
		<collection property="comm" 	resultMap="com.java501.S20230401.model.CommMapper.dgCommMap"/>
	</resultMap>
	<!-- 게시글의 유저 전체 조회 -->
<!-- 	<select id="ist" resultType="Article" parameterType="Member">
		Select  *
		From    (Select rownum as rn, a.*
		         From   (Select 	* 
		                 From   	article
		                 Where  	brd_id
		                 Between 	#{brd_id} and #{brd_id}+99
		                 Order by 	art_regdate desc) a)
		Where    rn between #{start} and #{end}
	</select> -->

	<!-- 게시판 카운트 -->
<!-- 	<select id="nt" resultType="int" parameterType="int">
		Select 	count(*)
		From 	article
		Where 	brd_id = #{brd_id}
	</select> -->
	
	<!-- 게시판 조회 -->
<!-- 	<select id="st" resultType="Article" parameterType="int">
		Select 	*
		From   (Select rownum as rn, a.*
		        From   (Select     *
		                From       article
		                Where      brd_id = #{brd_id}s
		                Order by   art_regdate desc) a)
		Where   rn between #{start} and #{end}
	</select> -->
	
	
	
	<!-- 최승환 -->
   <select id="memCount" parameterType="java.lang.String" resultType="int">
 		Select Count(*) from member  where id = #{mem_id}	
   </select>
</mapper>